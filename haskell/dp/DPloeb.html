<meta charset="utf-8">

<head>
<link rel="stylesheet" type="text/css" href="bootstrap.css">
</head>

<p> 
Note to self: solving a dynamic programming problem using <a href="http://carlo-hamalainen.net/blog/2013/11/28/note-to-self-loeb-and-moeb">l√∂b</a>. Literate Haskell source for this post is here: <a href="https://github.com/carlohamalainen/playground/blob/master/haskell/dp/DPloeb.lhs">DPloeb.lhs</a>.
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="color: blue; font-weight: bold;">module</span> <span style="">DPloeb</span> <span style="color: blue; font-weight: bold;">where</span>
</code></pre>
<p> 
The first solution is taken from <a href="http://blog.mno2.org/blog/2011/11/28/writing-dynamic-programming-in-haskell">http://blog.mno2.org/blog/2011/11/28/writing-dynamic-programming-in-haskell</a>.
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">coins</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">coins</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">1</span><span style="color: red;">,</span> <span class="hs-num">2</span><span style="color: red;">,</span> <span class="hs-num">5</span><span style="color: red;">,</span> <span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol1</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol1</span> <span style="color: red;">=</span> <span style="color: red;">(</span><span style="">!!</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">coins</span><span style="color: red;">)</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">ways1</span> <span style="">[]</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span>           <span style="">ways1</span> <span style="color: red;">(</span><span style="">c</span><span style="">:</span><span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>               <span style="color: blue; font-weight: bold;">where</span> <span style="">n</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways1</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main1</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main1</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol1</span> <span class="hs-num">200</span>
</code></pre>
<p> 
There are 73682 ways to select coins of the denominations specified in <code>coins</code> that sum to 200:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">*</span><span style="">DPloeb</span><span style="">&gt;</span> <span style="">main1</span>
<span style="">&gt;</span> <span class="hs-num">73682</span>
</code></pre>
<p> 
First step: roll out the parameter to <code>way</code>:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span> <span style="color: red;">-&gt;</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">ways2</span> <span style="">[]</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">1</span><span style="color: red;">,</span> <span class="hs-num">2</span><span style="color: red;">,</span> <span class="hs-num">5</span><span style="color: red;">,</span> <span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">1</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">2</span><span style="color: red;">,</span> <span class="hs-num">5</span><span style="color: red;">,</span> <span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">2</span><span style="color: red;">,</span> <span class="hs-num">5</span><span style="color: red;">,</span> <span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">2</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">5</span><span style="color: red;">,</span> <span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">5</span><span style="color: red;">,</span> <span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">5</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">10</span><span style="color: red;">,</span> <span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">10</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">20</span><span style="color: red;">,</span> <span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">20</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">50</span><span style="color: red;">,</span> <span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">50</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">100</span><span style="color: red;">,</span> <span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">100</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span class="hs-num">200</span><span style="color: red;">]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">200</span><span style="color: red;">]</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">200</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span style="">[]</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol2</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol2</span> <span style="color: red;">=</span> <span style="color: red;">(</span><span style="">!!</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways2</span> <span style="color: red;">[</span><span class="hs-num">1</span><span style="color: red;">,</span><span class="hs-num">2</span><span style="color: red;">,</span><span class="hs-num">5</span><span style="color: red;">,</span><span class="hs-num">10</span><span style="color: red;">,</span><span class="hs-num">20</span><span style="color: red;">,</span><span class="hs-num">50</span><span style="color: red;">,</span><span class="hs-num">100</span><span style="color: red;">,</span><span class="hs-num">200</span><span style="color: red;">]</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main2</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main2</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol2</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Next, change the parameter from <code>[Int]</code> to <code>Int</code> by indexing on integers instead of various lists:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">ways3</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">0</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">1</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">1</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">2</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">2</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">2</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">3</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">3</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">5</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">4</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">4</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">10</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">5</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">5</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">20</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">6</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">6</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">50</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">7</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">7</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">100</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">8</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">ways3</span> <span class="hs-num">8</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>     <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">200</span>
<span style="">&gt;</span>           <span style="">cs</span> <span style="color: red;">=</span> <span class="hs-num">0</span>
<span style="">&gt;</span>           <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways3</span> <span style="">cs</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol3</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol3</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">ways3</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main3</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main3</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol3</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Substitute the value of <code>cs</code> in the body of the <code>where</code> clauses:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">sol4</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">sol4</span> <span style="color: red;">=</span> <span style="">ways1</span>
<span style="">&gt;</span>   <span style="color: blue; font-weight: bold;">where</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways0</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways1</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">1</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways2</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways2</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">2</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways3</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways3</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">5</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways4</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways4</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">10</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways5</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways5</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">20</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways6</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways6</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">50</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways7</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways7</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">100</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways8</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways8</span> <span style="color: red;">=</span> <span style="">n</span>
<span style="">&gt;</span>       <span style="color: blue; font-weight: bold;">where</span> <span style="">c</span>  <span style="color: red;">=</span> <span class="hs-num">200</span>
<span style="">&gt;</span>             <span style="">n</span>  <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways0</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="">c</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">n</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main4</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main4</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol4</span> <span style="">!!</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Substitute the value of <code>c</code> in the body of the <code>where</code> clauses:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">sol5</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">sol5</span> <span style="color: red;">=</span> <span style="">ways1</span>
<span style="">&gt;</span>   <span style="color: blue; font-weight: bold;">where</span>
<span style="">&gt;</span>   <span style="">ways0</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span> 
<span style="">&gt;</span>   <span style="">ways1</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways2</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">1</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="">ways1</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways2</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways3</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">2</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="">ways2</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways3</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways4</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">5</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="">ways3</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways4</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways5</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">10</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="">ways4</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways5</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways6</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">20</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="">ways5</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways6</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways7</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">50</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="">ways6</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways7</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways8</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">100</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">ways7</span><span style="color: red;">)</span>
<span style="">&gt;</span>   <span style="">ways8</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways0</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">200</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">ways8</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main5</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main5</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol5</span> <span style="">!!</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Now tweak the type and collect each of the clauses into a list:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">ways6</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">ways6</span> <span style="color: red;">=</span> <span style="color: blue; font-weight: bold;">let</span> <span style="">ways0</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span>             <span style="">ways1</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways2</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">1</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="">ways1</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways2</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways3</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">2</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="">ways2</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways3</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways4</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">5</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="">ways3</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways4</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways5</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">10</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="">ways4</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways5</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways6</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">20</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="">ways5</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways6</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways7</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">50</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="">ways6</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways7</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways8</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">100</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">ways7</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways8</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="">ways0</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">200</span> <span class="hs-num">0</span> <span style="">++</span> <span style="">ways8</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span style="">ways0</span><span style="color: red;">,</span> <span style="">ways1</span><span style="color: red;">,</span> <span style="">ways2</span><span style="color: red;">,</span> <span style="">ways3</span><span style="color: red;">,</span> <span style="">ways4</span><span style="color: red;">,</span> <span style="">ways5</span><span style="color: red;">,</span> <span style="">ways6</span><span style="color: red;">,</span> <span style="">ways7</span><span style="color: red;">,</span> <span style="">ways8</span><span style="color: red;">]</span>
<span style="">&gt;</span>             <span style="color: blue; font-weight: bold;">in</span> <span style="">ways</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol6</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol6</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">ways6</span> <span style="">!!</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main6</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main6</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol6</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Instead of referring to <code>whys4</code>, index into the list with <code>why !! 4</code>:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">ways7</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">ways7</span> <span style="color: red;">=</span> <span style="color: blue; font-weight: bold;">let</span> <span style="">ways0</span> <span style="color: red;">=</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span>             <span style="">ways1</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">1</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways2</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">2</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways3</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">5</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways4</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">10</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways5</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">20</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways6</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">50</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways7</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">100</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways8</span> <span style="color: red;">=</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">0</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">200</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>             <span style="">ways</span> <span style="color: red;">=</span> <span style="color: red;">[</span><span style="">ways0</span><span style="color: red;">,</span> <span style="">ways1</span><span style="color: red;">,</span> <span style="">ways2</span><span style="color: red;">,</span> <span style="">ways3</span><span style="color: red;">,</span> <span style="">ways4</span><span style="color: red;">,</span> <span style="">ways5</span><span style="color: red;">,</span> <span style="">ways6</span><span style="color: red;">,</span> <span style="">ways7</span><span style="color: red;">,</span> <span style="">ways8</span><span style="color: red;">]</span>
<span style="">&gt;</span>             <span style="color: blue; font-weight: bold;">in</span> <span style="">ways</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol7</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol7</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">ways7</span> <span style="">!!</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main7</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main7</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol7</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Now we can define <code>ways</code> directly as a list:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">ways8</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">ways8</span> <span style="color: red;">=</span> <span style="color: blue; font-weight: bold;">let</span> <span style="">ways</span> <span style="color: red;">=</span> <span style="color: red;">[</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">1</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">2</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">5</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">10</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">20</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">50</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">100</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">0</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">200</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">ways</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">]</span>
<span style="">&gt;</span>             <span style="color: blue; font-weight: bold;">in</span> <span style="">ways</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol8</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol8</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">ways8</span> <span style="">!!</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main8</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main8</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol8</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Factor out <code>whys</code> by writing each list element as a function.
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">ways9</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">ways9</span> <span style="color: red;">=</span> <span style="color: blue; font-weight: bold;">let</span> <span style="">fs</span>   <span style="color: red;">=</span> <span style="color: red;">[</span> <span style="">const</span> <span style="">$</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">1</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">2</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">5</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">10</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">20</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">50</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">100</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">0</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">200</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                    <span style="color: red;">]</span>
<span style="">&gt;</span>             <span style="">ways</span> <span style="color: red;">=</span> <span style="">map</span> <span style="color: red;">(</span><span style="">$</span> <span style="">ways</span><span style="color: red;">)</span> <span style="">fs</span>
<span style="">&gt;</span>             <span style="color: blue; font-weight: bold;">in</span> <span style="">ways</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol9</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol9</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">ways9</span> <span style="">!!</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main9</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main9</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol9</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Now use <code>loeb</code>:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">loeb</span> <span style="color: red;">::</span> <span style="">Functor</span> <span style="">f</span> <span style="color: red;">=&gt;</span> <span style="">f</span> <span style="color: red;">(</span><span style="">f</span> <span style="">b</span> <span style="color: red;">-&gt;</span> <span style="">b</span><span style="color: red;">)</span> <span style="color: red;">-&gt;</span> <span style="">f</span> <span style="">b</span>
<span style="">&gt;</span> <span style="">loeb</span> <span style="">fs</span> <span style="color: red;">=</span> <span style="">go</span> <span style="color: blue; font-weight: bold;">where</span> <span style="">go</span> <span style="color: red;">=</span> <span style="">fmap</span> <span style="color: red;">(</span><span style="">$</span> <span style="">go</span><span style="color: red;">)</span> <span style="">fs</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">fs10</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="color: red;">[</span><span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span> <span style="color: red;">-&gt;</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span>
<span style="">&gt;</span> <span style="">fs10</span>   <span style="color: red;">=</span> <span style="color: red;">[</span> <span style="">const</span> <span style="">$</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">1</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">2</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">2</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">5</span>   <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">3</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">10</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">4</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">20</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">5</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">50</span>  <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">6</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">100</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">7</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">,</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">0</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span class="hs-num">200</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">8</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>          <span style="color: red;">]</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol10</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol10</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">loeb</span> <span style="">fs10</span> <span style="">!!</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main10</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main10</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol10</span> <span class="hs-num">200</span>
</code></pre>
<p> 
Finally, we can generalise this solution by writing a function to produce the elements of <code>fs10</code>:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">make</span> <span style="color: red;">::</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span> <span style="color: red;">-&gt;</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="color: red;">(</span><span style="color: red;">[</span><span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">]</span> <span style="color: red;">-&gt;</span> <span style="color: red;">[</span><span style="">Int</span><span style="color: red;">]</span><span style="color: red;">)</span>
<span style="">&gt;</span> <span style="">make</span> <span style="color: blue; font-weight: bold;">_</span>  <span class="hs-num">0</span> <span style="color: red;">=</span> <span style="">const</span> <span style="">$</span> <span class="hs-num">1</span> <span style="">:</span> <span style="">repeat</span> <span class="hs-num">0</span>
<span style="">&gt;</span> <span style="">make</span> <span style="">cs</span> <span style="">k</span> <span style="color: red;">=</span> <span style="color: blue; font-weight: bold;">if</span> <span style="">k</span> <span style="">==</span> <span style="">length</span> <span style="">cs</span>
<span style="">&gt;</span>                 <span style="color: blue; font-weight: bold;">then</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span class="hs-num">0</span><span style="color: red;">)</span>     <span style="color: red;">(</span><span style="">replicate</span> <span style="color: red;">(</span><span style="">cs</span> <span style="">!!</span> <span style="color: red;">(</span><span style="">k</span><span style="color: green;">-</span><span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span style="">k</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span>                 <span style="color: blue; font-weight: bold;">else</span> <span style="color: red;">\</span><span style="">w</span> <span style="color: red;">-&gt;</span> <span style="">zipWith</span> <span style="color: red;">(</span><span style="">+</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span style="color: red;">(</span><span style="">k</span><span style="">+</span><span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span> <span style="color: red;">(</span><span style="">replicate</span> <span style="color: red;">(</span><span style="">cs</span> <span style="">!!</span> <span style="color: red;">(</span><span style="">k</span><span style="color: green;">-</span><span class="hs-num">1</span><span style="color: red;">)</span><span style="color: red;">)</span> <span class="hs-num">0</span> <span style="">++</span> <span style="color: red;">(</span><span style="">w</span> <span style="">!!</span> <span style="">k</span><span style="color: red;">)</span><span style="color: red;">)</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">sol11</span> <span style="color: red;">::</span> <span style="">Int</span> <span style="color: red;">-&gt;</span> <span style="">Int</span>
<span style="">&gt;</span> <span style="">sol11</span> <span style="">x</span> <span style="color: red;">=</span> <span style="">result</span> <span style="">!!</span> <span class="hs-num">1</span> <span style="">!!</span> <span style="">x</span>
<span style="">&gt;</span>   <span style="color: blue; font-weight: bold;">where</span> <span style="">result</span> <span style="color: red;">=</span> <span style="">loeb</span> <span style="">$</span> <span style="">map</span> <span style="color: red;">(</span><span style="">make</span> <span style="">coins</span><span style="color: red;">)</span> <span style="color: red;">[</span><span class="hs-num">0</span><span style="color: red;">..</span><span style="">length</span> <span style="">coins</span><span style="color: red;">]</span>
<span style="">&gt;</span> 
<span style="">&gt;</span> <span style="">main11</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">main11</span> <span style="color: red;">=</span> <span style="">print</span> <span style="">$</span> <span style="">sol11</span> <span class="hs-num">200</span>
</code></pre>
<p> 
These all say 73682:
</p>

<pre class="sourceCode haskell"><code class="sourceCode haskell"><span style="">&gt;</span> <span style="">mains</span> <span style="color: red;">::</span> <span style="">IO</span> <span style="">()</span>
<span style="">&gt;</span> <span style="">mains</span> <span style="color: red;">=</span> <span style="color: blue; font-weight: bold;">do</span> <span style="">main1</span>
<span style="">&gt;</span>            <span style="">main2</span>
<span style="">&gt;</span>            <span style="">main3</span>
<span style="">&gt;</span>            <span style="">main4</span>
<span style="">&gt;</span>            <span style="">main5</span>
<span style="">&gt;</span>            <span style="">main6</span>
<span style="">&gt;</span>            <span style="">main7</span>
<span style="">&gt;</span>            <span style="">main8</span>
<span style="">&gt;</span>            <span style="">main9</span>
<span style="">&gt;</span>            <span style="">main10</span>
<span style="">&gt;</span>            <span style="">main11</span>
</code></pre>
<div class="references">

</div>
